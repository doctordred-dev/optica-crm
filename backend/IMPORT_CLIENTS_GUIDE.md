# üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ Excel

## üéØ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

–°–∫—Ä–∏–ø—Ç `importClientsFromExcel.js` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ Excel —Ñ–∞–π–ª–∞ –≤ MongoDB –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ (–¥–æ–±–∞–≤–ª—è–µ—Ç +380 –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è
- ‚úÖ –ò–º–ø–æ—Ä—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–º–ø–æ—Ä—Ç–∞

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel:

```bash
cd /Users/vladislav/Documents/optica-crm/backend
npm install xlsx
```

## üöÄ –ó–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞

```bash
node src/scripts/importClientsFromExcel.js
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

**–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞:**
- `–Ü–º'—è` / `–ò–º—è` / `–ü–Ü–ë` / `–§–ò–û` / `Name` / `name`

**–¢–µ–ª–µ—Ñ–æ–Ω:**
- `–¢–µ–ª–µ—Ñ–æ–Ω` / `–¢–µ–ª–µ—Ñ–æ–Ω 1` / `Phone` / `phone` / `–ù–æ–º–µ—Ä`

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è:

**–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:**
- `–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è` / `–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è` / `Birth Date` / `birthDate`

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:**
- `–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ` / `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏` / `Comments` / `comments` / `–ü—Ä–∏–º—ñ—Ç–∫–∏`

**–ò—Å—Ç–æ—á–Ω–∏–∫:**
- `–î–∂–µ—Ä–µ–ª–æ` / `–ò—Å—Ç–æ—á–Ω–∏–∫` / `Source` / `source`

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ –≤–∞—à—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É

–ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –≤ –≤–∞—à–µ–º Excel —Ñ–∞–π–ª–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª:
`src/scripts/importClientsFromExcel.js`

–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ 90-94):
```javascript
const name = row['–Ü–º\'—è'] || row['–ò–º—è'] || ...
const phone = row['–¢–µ–ª–µ—Ñ–æ–Ω'] || row['Phone'] || ...
```

–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫.

## üìù –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
‚úÖ MongoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
üìÇ –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞: /Users/vladislav/Documents/optica-crm/–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –±–∞–∑–∞ –æ–∫—É–ª—è—Ä—ñ–≤.xlsx
üìä –ù–∞–π–¥–µ–Ω–æ –∑–∞–ø–∏—Å–µ–π –≤ Excel: 150

üîÑ –ù–∞—á–∏–Ω–∞–µ–º –∏–º–ø–æ—Ä—Ç...

‚úÖ –°—Ç—Ä–æ–∫–∞ 1: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤" (+380501234567)
‚úÖ –°—Ç—Ä–æ–∫–∞ 2: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω "–ú–∞—Ä—ñ—è –ö–æ–≤–∞–ª—å" (+380671234567)
‚ö†Ô∏è  –°—Ç—Ä–æ–∫–∞ 3: –ö–ª–∏–µ–Ω—Ç "–û–ª–µ–≥ –°–∏–¥–æ—Ä–æ–≤" (+380931234567) —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úÖ –°—Ç—Ä–æ–∫–∞ 4: –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω "–ê–Ω–Ω–∞ –®–µ–≤—á–µ–Ω–∫–æ" (+380501234568)

üéâ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: 120
   ‚ö†Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 25
   ‚ùå –û—à–∏–±–æ–∫: 5
   üìù –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 150
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è**: –ü–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º —Å–¥–µ–ª–∞–π—Ç–µ backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **–î—É–±–ª–∏–∫–∞—Ç—ã**: –ö–ª–∏–µ–Ω—Ç—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏ –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã
3. **–§–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤**: –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω—ã –∫ —Ñ–æ—Ä–º–∞—Ç—É +380XXXXXXXXX
4. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Cannot find module 'xlsx'"
```bash
npm install xlsx
```

### –û—à–∏–±–∫–∞: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω"
–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
npm run create-admin
```

### –û—à–∏–±–∫–∞: "File not found"
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –±–∞–∑–∞ –æ–∫—É–ª—è—Ä—ñ–≤.xlsx` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```
/Users/vladislav/Documents/optica-crm/–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –±–∞–∑–∞ –æ–∫—É–ª—è—Ä—ñ–≤.xlsx
```

–ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –≤ —Å–∫—Ä–∏–ø—Ç–µ (—Å—Ç—Ä–æ–∫–∞ 59):
```javascript
const excelFilePath = path.join(__dirname, '../../../–í–ê–®_–§–ê–ô–õ.xlsx');
```

## üìû –§–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

–°–∫—Ä–∏–ø—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω—ã –≤ –ª—é–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:
- `0501234567` ‚Üí `+380501234567`
- `380501234567` ‚Üí `+380501234567`
- `+380501234567` ‚Üí `+380501234567`
- `8 (050) 123-45-67` ‚Üí `+380501234567`

## üîÑ –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç

–°–∫—Ä–∏–ø—Ç –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–ª–∏–µ–Ω—Ç—ã (–ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É) –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã.
